---
output: github_document
always_allow_html: yes
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# GDPuc

<!-- badges: start -->

[![R-CMD-check](https://github.com/johanneskoch94/GDPuc/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/johanneskoch94/GDPuc/actions/workflows/R-CMD-check.yaml)
[![codecov](https://codecov.io/gh/johanneskoch94/GDPuc/branch/main/graph/badge.svg?token=3GHXFQXARX)](https://codecov.io/gh/johanneskoch94/GDPuc)
<!-- badges: end -->

GDPuc (a.k.a. GDP unit-conversion) provides a single function to convert GDP time-series data from one unit to another. All common GDP units are supported, i.e.:

-   current LCU
-   current US$MER
-   current Int$PPP
-   constant YYYY LCU
-   constant YYYY US$MER
-   constant YYYY Int$PPP  

where "YYYY" is a placeholder for a year, e.g. "2010" or "2015".

## Installation

There currently only exists the development version on github. 

Open a R session on your machine and use the `remotes` package to install GDPuc.

```{r, eval = FALSE}
# Install remotes if necessary:
install.packages("remotes")

# Install GDPuc from github:
remotes::install_github("johanneskoch94/GDPuc")
```

## Usage

Load the package.

```{r eval=FALSE}
library(GDPuc)
```

The main function of the package is `convertGDP`. 

```{r usage1, eval=FALSE}
convertGDP(
  gdp = gdp, 
  unit_in = "constant 2005 LCU", 
  unit_out = "constant 2017 Int$PPP"
)
```

Here, the `gdp` argument takes a tibble or a data-frame that contains, at least:

-   a column with iso3c country codes, (ideally named "iso3c")
-   a column with the year, (ideally named "year")
-   a column named "value", with the gdp data 

A corresponding magpie object, see the [magclass](https://github.com/pik-piam/magclass) package, is also accepted.  


Use the `source` argument to control the source of the underlying conversion factors (GDP deflators, MERs and PPPs). 
There are a couple of source options shipped with the package, with `wb_wdi` set as default, but custom sources are possible. 

```{r usage2, eval=FALSE}
convertGDP(
  gdp = gdp, 
  unit_in = "constant 2005 LCU", 
  unit_out = "constant 2017 Int$PPP",
  source = "wb_wdi"
)
```

Use `print_source_info` to print information on a specfic, or all available sources.

```{r eval=FALSE}
print_source_info()
print_source_info("wb_wdi")
```


Set the `verbose` argument to `TRUE` to print out the underlying conversion steps and factors. The verbosity can also be controlled via the option `"GDPuc.verbose"`. 

```{r usage3, eval=FALSE}
convertGDP(
  gdp = gdp, 
  unit_in = "constant 2005 LCU", 
  unit_out = "constant 2017 Int$PPP",
  verbose = TRUE
)
```


## Example

```{r example1}
library(GDPuc)

gdp <- tibble::tibble(
  iso3c = "USA", 
  year = 2010:2014, 
  value = 100:104
)
print(gdp)

convertGDP(
  gdp = gdp, 
  unit_in = "constant 2005 LCU", 
  unit_out = "constant 2017 Int$PPP"
)
```

Setting `verbose = TRUE` will additionally print the following information to the console:

```{r, eval=FALSE}
convertGDP(
  gdp = gdp, 
  unit_in = "constant 2005 LCU", 
  unit_out = "constant 2017 Int$PPP",
  verbose = TRUE
)
```

```{r, include = FALSE}
# Turn on ANSI colors
options(cli.num_colors = 256L)
asciicast::init_knitr_engine(echo_input = FALSE)
```

```{asciicast example_cli}
library(GDPuc)
gdp <- tibble::tibble(iso3c = "USA", year = 2010:2020, value = 100:110)
x <- convertGDP(
  gdp = gdp, 
  unit_in = "constant 2005 LCU", 
  unit_out = "constant 2017 Int$PPP",
  verbose = TRUE
)
```
